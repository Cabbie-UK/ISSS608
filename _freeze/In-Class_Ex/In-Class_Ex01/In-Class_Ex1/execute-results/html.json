{
  "hash": "f8045e35b6700cde0d726f2b19fbc27b",
  "result": {
    "markdown": "---\ntitle: \"A Light Makeover of ggplots\"\nauthor: \"KB\"\neditor: visual\nexecute:\n  freeze: auto \n  warning: false\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n    code-line-numbers: true\n---\n\n\nFirst published: 17-Apr-2023\n\n![](images/paste-45304572.png){fig-align=\"center\"}\n\n## 1.1 Learning Outcome\n\nWe will:\n\n-   use the graphic layers of ggplot2 to touch up various plots to make them more intuitive and appealing.\n\n## 1.2 Getting Started\n\n### 1.2.1 Install and load the required r libraries\n\nLoad the **tidyverse** library.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse)\n```\n:::\n\n\n### 1.2.2 Import the data\n\nWe will be using the same exam scores data-set that was featured in my [Hands-On Ex 1](https://boomie-boom-isss608.netlify.app/hands-on_ex/hands-on_ex01/hands-on_ex1#import-the-data \"Additional info on the data-set\").\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv('data/Exam_data.csv', show_col_types = FALSE )\n```\n:::\n\n\n## 1.3 Candidates for Makeover\n\n### 1.3.1 Working with theme\n\nWe can use the `theme()` function to change the colors of the plot panel background of the following plot to light blue and the color of grid lines to white. We will also include the title and subtitle to make the plot more meaningful.\n\n::: panel-tabset\n## Before\n\n\n::: {.cell fig.size='6'}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar() +\n  ylab('Count') +\n  theme_minimal() + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\n## After\n\n\n::: {.cell fig.size='6'}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar() +\n  ylab('Count') +\n  theme_minimal() + \n  coord_flip() +\n  \n  theme(\n    panel.background = element_rect(fill = \"lightblue\", colour = \"lightblue\"),\n    panel.grid.major = element_line(size = 0.75, linetype = 'solid', colour = \"white\"), \n    panel.grid.minor = element_line(size = 0.25, linetype = 'solid', colour = \"white\")\n      \n  ) +\n  \n  labs(title = \"Chinese Students Formed The Bulk Of The Cohort\",\n       subtitle = \"This was followed by Malay and Indian students\")\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-4-1.png){width=576}\n:::\n:::\n\n:::\n\n### 1.3.2 Sort and label the columns in a chart\n\nFor the column chart displayed below, we have to address the following criticisms:\n\n-   y-axis title is not clear (i.e.Â count)\n\n-   To support effective comparison, the bars should be sorted by their respective frequencies.\n\n-   For static graph, frequency values should be added to provide addition information.\n\nTo address the first comment, we use `ylab()` and `theme()` function to relabel and calibrate the position of the y-axis title. For the 2nd and 3rd comment, we first summarise the data-set using `group_by()` and `summarise()` function to get the count of pupils by race. Thereafter, we use the `reorder()` function to sort the columns and `geom_text()` function to display the count.\n\n::: panel-tabset\n## Before\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar() +\n  ylim(0,220) \n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## After\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group the data by Race and aggregate by pupil count\nsorted_data <- exam_data %>% group_by(RACE) %>% summarise(count=n()) \n\n# Plot the chart\nggplot(data = sorted_data, aes(x=reorder(RACE, -count),y=count)) +\n  ylim(0,220) +\n  geom_col() +\n  ylab('No. of\\nPupils') +\n  theme(axis.title.y = element_text(angle = 0, vjust = 0.5, hjust=1))+\n  xlab('Race') +\n  geom_text(aes(label = count), vjust = -0.5, size = 3.5) +\n  labs(title = \"Chinese Pupils Formed The Bulk Of The Cohort\",\n       subtitle = \"This was followed by Malay and Indian pupils\")\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n:::\n\n### 1.3.3 Add mean and median lines on the histogram\n\nWe can use the `geom_vline()` function to add a computed mean and median line onto the chart.\n\n::: panel-tabset\n## Before\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS)) +\n  geom_histogram(bins = 20)\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## After\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  geom_vline(aes(xintercept=mean(MATHS, na.rm=T)),\n             color=\"red\", \n             linetype=\"dashed\", \n             size=1) +\n  geom_vline(aes(xintercept=median(MATHS, na.rm=T)),\n             color=\"grey30\",\n             linetype=\"dashed\", \n             size=1) +\n            xlab('Maths Score') +\n            ylab('Count') +\n  annotate(\"label\", color = \"red\", x=mean(exam_data$MATHS, na.rm=T)+2, y=50,\n          label=paste(\"Mean: \", round(mean(exam_data$MATHS, na.rm=T), 1)),fill = \"white\") +\n  annotate(\"label\",color=\"grey30\", x=median(exam_data$MATHS, na.rm=T)+2, y=40,\n          label=paste(\"Median: \", round(median(exam_data$MATHS, na.rm=T), 1)),fill = \"white\") + \n  labs(title = \"The Median score for Maths exam was 74\",\n         subtitle = \"We have a small porpotion of pupils who scored less than 25 marks\")\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n:::\n\n### 1.3.4 Make the basic histogram more informative\n\nThe histograms below are elegantly designed but not informative. This is because they only reveal the distribution of English scores by gender but without context such as the score distribution for all pupils.\n\nTo show the distribution of English scores for all pupils as the background, we can add another `geom_histogram()` layer for all pupils.\n\n::: panel-tabset\n## Before\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = ENGLISH )) +\n  geom_histogram() +\n  facet_wrap(~ GENDER) +\n  guides(fill = FALSE) \n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## After\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- exam_data\n\n#create a d_bg dataframe without the gender attribute\nd_bg <- d[, -3]  \n\nggplot(d, aes(x = ENGLISH, fill = GENDER)) +\n  geom_histogram(data = d_bg, fill = \"grey\", alpha = .5) +\n  geom_histogram(colour = \"black\") +\n  facet_wrap(~ GENDER) +\n  # guides = false removes the legend from the chart\n  scale_fill_manual(values = c(\"Female\" = \"pink\", \"Male\" = \"light blue\")) +\n  guides(fill = FALSE) +  \n  theme_bw() +\n  labs(title = \"Female pupils scored higher marks than male pupils for English\",\n         subtitle = \"Their score distn covered the overall score distn for all pupuls on the right side fo the chart\")\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n:::\n\n### 1.3.5 Dividing a chart into 4 quadrants\n\nWe can use `geom_hline()` and `geom_vline()` to divide the chart into equal quadrants (see After(1)). At the same time, we can use the `coord_cartesian()` function to adjust the limits of the coordinate system for a plot to only display the data that falls within those limits.\n\nIn After (2), I included a regression line and swtich the background to white (using `theme_minimal()`) to make the relationship between English and Math scores more prominent.\n\n::: panel-tabset\n## Before\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x=MATHS, y=ENGLISH)) +\n  geom_point() +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(20,99))\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## After (1)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x=MATHS, y=ENGLISH)) +\n  geom_point() +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  geom_hline(yintercept=50,\n             linetype=\"dashed\",\n             color=\"grey60\",\n             size=1) + \n  geom_vline(xintercept=50, \n             linetype=\"dashed\",\n             color=\"grey60\",\n             size=1) +\n  labs(title = \"Pupils who did well in English tend to excel in Math as well\",\n         subtitle = \"There is a positive correlation between English and Math scores\") \n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## After (2)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x=MATHS, y=ENGLISH)) +\n  geom_point() +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  geom_smooth(method=lm,linewidth=1.0)  +\n  labs(title = \"Pupils who did well in English tend to excel in Math as well\",\n         subtitle = \"There is a positive correlation between English and Math scores\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](In-Class_Ex1_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {style=\"text-align: center\"}\n$**That's$ $all$ $folks!**$\n:::\n",
    "supporting": [
      "In-Class_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}