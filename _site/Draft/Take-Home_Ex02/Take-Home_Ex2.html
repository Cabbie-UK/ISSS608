<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="KB">
<meta name="dcterms.date" content="2023-05-25">

<title>KB’s Visual Analytics - FishEye Knowldge Graph: Identify Temporal Patterns of individual entities and between entities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">KB’s Visual Analytics</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">Hands-on Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex01/Hands-on_Ex1.html">
 <span class="dropdown-text">1 A Layered Grammar of Graphics - ggplot2 methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex02/Hands-on_Ex2.html">
 <span class="dropdown-text">2 Beyond ggplot2 Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex03/Hands-on_Ex3a.html">
 <span class="dropdown-text">3 Programming Interactive Data Visualisations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex03/Hands-on_Ex3b.html">
 <span class="dropdown-text">4 Programming Animated Data Visualisations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4a.html">
 <span class="dropdown-text">5 Visual Statistical Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4b.html">
 <span class="dropdown-text">6 Visualise Uncertainty</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4c.html">
 <span class="dropdown-text">7 Funnel Plots for Fair Comparison</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex05/Hands-on_Ex5a.html">
 <span class="dropdown-text">8 Visualise Distributions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex05/Hands-on_Ex5b.html">
 <span class="dropdown-text">9 Visualise Network Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6a.html">
 <span class="dropdown-text">10 Ternary Plot to display composition of 3 variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6b.html">
 <span class="dropdown-text">11 Visual Correlation Analysis of Numerical and Categorical Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6c.html">
 <span class="dropdown-text">12 Heatmap to visualise Multivariate Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6d.html">
 <span class="dropdown-text">13 Visual Multivariate Analysis with Parallel Coordinates Plot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6e.html">
 <span class="dropdown-text">14 Treemap Visualisation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">In-class Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex01/In-Class_Ex1.html">
 <span class="dropdown-text">1 A Light Makeover of ggplots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex03/In-Class_Ex3.html">
 <span class="dropdown-text">2 Publishing a Quarto Document</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex04/In-Class_Ex4.html">
 <span class="dropdown-text">3 Quantile–quantile plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex05/In-Class_Ex5.html">
 <span class="dropdown-text">4 Working with json files for Network Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">Take-home Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex1.html">
 <span class="dropdown-text">City of Engagement: Demographics and Financial Health of Residents</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://kaleidoscopic-bunny-isss624.netlify.app/">KB’s GeoSpatial Analytics</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">FishEye Knowldge Graph: Identify Temporal Patterns of individual entities and between entities</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../" class="sidebar-logo-link">
      <img src="../../dataviz.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">In-class Exercises</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-Class_Ex/In-Class_Ex01/In-Class_Ex1.html" class="sidebar-item-text sidebar-link">1 A Light Makeover of ggplots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-Class_Ex/In-Class_Ex03/In-Class_Ex3.html" class="sidebar-item-text sidebar-link">2 Publishing a Quarto Document</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-Class_Ex/In-Class_Ex04/In-Class_Ex4.html" class="sidebar-item-text sidebar-link">3 Quantile–quantile plots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-Class_Ex/In-Class_Ex05/In-Class_Ex5.html" class="sidebar-item-text sidebar-link">4 Working with json files for Network Analysis</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Take-home Exercises</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex1.html" class="sidebar-item-text sidebar-link">City of Engagement: Demographics and Financial Health of its Residents</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Hands-on Exercises</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex01/Hands-on_Ex1.html" class="sidebar-item-text sidebar-link">1 A Layered Grammar of Graphics - ggplot2 methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex02/Hands-on_Ex2.html" class="sidebar-item-text sidebar-link">2 Beyond ggplot2 Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex03/Hands-on_Ex3a.html" class="sidebar-item-text sidebar-link">3 Programming Interactive Data Visualisations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex03/Hands-on_Ex3b.html" class="sidebar-item-text sidebar-link">4 Programming Animated Data Visualisations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4a.html" class="sidebar-item-text sidebar-link">5 Visual Statistical Analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4b.html" class="sidebar-item-text sidebar-link">6 Visualise Uncertainty</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex04/Hands-on_Ex4c.html" class="sidebar-item-text sidebar-link">7 Funnel Plots for Fair Comparison</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex05/Hands-on_Ex5a.html" class="sidebar-item-text sidebar-link">8 Visualise Distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex05/Hands-on_Ex5b.html" class="sidebar-item-text sidebar-link">9 Visualise Network Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6a.html" class="sidebar-item-text sidebar-link">10 Ternary Plot to display composition of 3 variables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6b.html" class="sidebar-item-text sidebar-link">11 Visual Correlation Analysis of Numerical and Categorical Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6c.html" class="sidebar-item-text sidebar-link">12 Heatmap to visualise Multivariate Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6d.html" class="sidebar-item-text sidebar-link">13 Visual Multivariate Analysis with Parallel Coordinates Plot</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-On_Ex/Hands-On_Ex06/Hands-on_Ex6e.html" class="sidebar-item-text sidebar-link">14 Treemap Visualisation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Tableau</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Tableau/1_Superstore.html" class="sidebar-item-text sidebar-link">Superstore Annual Sales and Profit</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Tableau/2_Superstore_Story.html" class="sidebar-item-text sidebar-link">The Superstore Story</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Tableau/3_Animation_CrossFiltering.html" class="sidebar-item-text sidebar-link">Animinated Bubbleplot and Cross-Filtering of Charts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Tableau/4_multivariate_plots.html" class="sidebar-item-text sidebar-link">Plots for multi-variate analysis</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-all-relevant-packages" id="toc-load-all-relevant-packages" class="nav-link active" data-scroll-target="#load-all-relevant-packages">Load all relevant packages</a></li>
  <li><a href="#read-the-original-nodes-table" id="toc-read-the-original-nodes-table" class="nav-link" data-scroll-target="#read-the-original-nodes-table">Read the original nodes table</a></li>
  <li><a href="#read-the-original-edge-table" id="toc-read-the-original-edge-table" class="nav-link" data-scroll-target="#read-the-original-edge-table">Read the original edge table</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">FishEye Knowldge Graph: Identify Temporal Patterns of individual entities and between entities</h1>
<p class="subtitle lead">VAST Chaellenge 2023: Mini-Challenge 2</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>KB </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 25, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>(First Published: May 28, 2023)</p>
<section id="load-all-relevant-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-all-relevant-packages">Load all relevant packages</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(igraph, tidygraph, ggraph, visNetwork, lubridate, clock,               tidyverse, graphlayouts,jsonlite, plotly, patchwork, knitr, kableExtra, igraph, ggdist, heatmaply)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>, <span class="at">digits =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>import data</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mc2 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Extract the nodes info from mc2 data frame</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mc2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">select</span>(id, shpcountry, rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>id -- Name of the company that originated (or received) the shipment</p></li>
<li><p>shpcountry -- Country the company most often associated with when shipping</p></li>
<li><p>rcvcountry -- Country the company most often associated with when receiving</p></li>
</ul>
</section>
<section id="read-the-original-nodes-table" class="level2">
<h2 class="anchored" data-anchor-id="read-the-original-nodes-table">Read the original nodes table</h2>
<p>We will store mc2_nodes in rds format for ease of subsequent retrieval. This code need only be executed once and henece. Thereafter we will reload the mc2_nodes dataframe again</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># write_rds(mc2_nodes, "data/mc2_nodes.rds")</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>mc2_nodes <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"data/mc2_nodes.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Extract the edges info from mc2 data frame</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mc2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">select</span>(source, target, arrivaldate, hscode, valueofgoods_omu, volumeteu, weightkg,  valueofgoodsusd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>arrivaldate -- Date the shipment arrived at port in YYYY-MM-DD format.</p></li>
<li><p>hscode -- Harmonized System code for the shipment. Can be joined with the hscodes table to get additional details.</p></li>
<li><p>valueofgoods_omu -- Customs-declared value of the total shipment, in Oceanus Monetary Units (OMU)</p></li>
<li><p>volumeteu -- The volume of the shipment in ‘Twenty-foot equivalent units’, roughly how many 20-foot standard containers would be required. (Actual number of containers may have been different as there are 20ft and 40ft standard containers and tankers that do not use containers)</p></li>
<li><p>weightkg -- The weight of the shipment in kilograms (if known)</p></li>
</ul>
</section>
<section id="read-the-original-edge-table" class="level2">
<h2 class="anchored" data-anchor-id="read-the-original-edge-table">Read the original edge table</h2>
<p>Also store the mc2_edge info in native rds format.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">#write_rds(mc2_edges, "data/mc2_edges.rds")</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>mc2_edges <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/mc2_edges.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span> <span class="fu">as.Date</span>(arrivaldate, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Aggregate the weight information between each pair of notes and by the relationship type</p>
<p>Get summary stats on the edge data frame</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">summary</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Remove likely duplicate records from edges</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Check for the presence of duplicate edge </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">paste</span>(<span class="fu">sum</span>(<span class="fu">duplicated</span>(mc2_edges)),<span class="st">"duplicate records."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are unsure of the reasons behind the duplicate records and do not discount the possibility that they could be genuine. On balance, we find it unlikely that duplicate records exist for every day, with same weight and among the same pair of entities. Hence, we will use the <code>distinct()</code> function on the edge data to only retain only unique edge records for our analysis.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>mc2_edges_unique <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">distinct</span>()</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="fu">summary</span>(mc2_edges_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Identifying edge records that relate to the fishing industry</strong></p>
<p>We extract the top 5 HS code used for the edge records and match against the <a href="https://www.wcoomd.org/en/topics/nomenclature/instrument-and-tools/hs-nomenclature-2022-edition/hs-nomenclature-2022-edition.aspx">HS Nomenclature 2022</a> available at World Customs Organisation (WCO)’s website, supplemented by the HSN Code List that is found on <a href="https://connect2india.com/hs-classification.html">Connect2India</a> website.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>hscode_count <span class="ot">&lt;-</span> mc2_edges_unique <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">group_by</span>(hscode) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  ungroup </span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="fu">head</span>(hscode_count[<span class="fu">order</span>(<span class="sc">-</span>hscode_count<span class="sc">$</span>count), ],<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<caption>From the above, it is obvious not all transactions relate to fishing, We scanned WCO’s HS Nomenclature 2022 edition and identified a list 46 HS codes which are associated with fish or the fishing industry and import them in our work environment,</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>S/No.</th>
<th>HS Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>306170</td>
<td>Fish and crustaceans, molluscs and other aquatic invertebrates.</td>
</tr>
<tr class="even">
<td>2</td>
<td>950300</td>
<td>Tricycles, scooters, pedal cars and similar wheeled toys; dolls’ carriages; dolls; other toys; reduced-size (“scale”) models and similar recreational models, working or not; puzzles of all kinds.</td>
</tr>
<tr class="odd">
<td>3</td>
<td>870899</td>
<td>Other parts and accessories of the motor vehicles</td>
</tr>
<tr class="even">
<td>4</td>
<td>611020</td>
<td>Cotton jerseys, pullovers, cardigans, waistcoats and similar articles, knitted or crocheted.</td>
</tr>
<tr class="odd">
<td>5</td>
<td>940360</td>
<td>Other wooden furniture</td>
</tr>
</tbody>
</table>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>hscode_fish <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/lookup_hscode.csv'</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">mutate</span>(<span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will use this list to extract edge records related to fish industry.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>mc2_edges_fish <span class="ot">&lt;-</span> mc2_edges_unique <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(hscode <span class="sc">%in%</span> hscode_fish<span class="sc">$</span>hscode) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="co"># further filter by code '1604','1605 for fish products</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">filter</span>(<span class="fu">substr</span>(hscode,<span class="at">start =</span> <span class="dv">1</span>,<span class="at">stop=</span><span class="dv">4</span>) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'1604'</span>,<span class="st">'1605'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We do a frequency count by hscode to understand the volume for each hscode, the subset contains 30 hscodes pertaining to different types of seafood.</p>
<p><strong>Prepare the Edges for Analysis</strong></p>
<p>Group edges by source, target, date, and aggregate by count ( which will be renamed as weight), sum of weight, sum of value</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># minimum count (or weight) cut-off for a substantial relationship to exist over 7 years</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>cut_off <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># group by edges </span></span>
<span id="cb13-6"><a href="#cb13-6"></a>mc2_edges_aggregated <span class="ot">&lt;-</span> mc2_edges_fish <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">mutate</span>(<span class="at">weeknumber =</span> <span class="fu">isoweek</span>(arrivaldate),</span>
<span id="cb13-8"><a href="#cb13-8"></a>         <span class="at">year_month =</span> <span class="fu">format</span>(arrivaldate,<span class="st">"%Y-%m"</span>),</span>
<span id="cb13-9"><a href="#cb13-9"></a>         <span class="at">year =</span> <span class="fu">year</span>(arrivaldate)) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">group_by</span>(source,target,hscode, year_month, year) <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),<span class="at">weight_sum =</span> <span class="fu">sum</span>(weightkg),<span class="at">value_goods_sum =</span><span class="fu">sum</span>(valueofgoodsusd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="fu">filter</span>(weight<span class="sc">&gt;</span>cut_off) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>  ungroup <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>  <span class="fu">inner_join</span>(<span class="fu">select</span>(hscode_fish, hscode, short_desc), <span class="at">by =</span> <span class="st">"hscode"</span>)</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co"># Save a copy of the edge file</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="fu">write_rds</span>(mc2_edges_aggregated, <span class="st">"data/mc2_edges_aggregated.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># load the edge file</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>mc2_edges_aggregated <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"data/mc2_edges_aggregated.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>y-o-y plot</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>weight_yoy <span class="ot">=</span> <span class="fu">ggplot</span>(mc2_edges_aggregated, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">as.factor</span>(year), <span class="at">y =</span> weight_sum<span class="sc">/</span><span class="dv">1000000</span>)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="co">#geom_text(aes(label = weight_sum), vjust = -0.5,color='white') +</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Weight(kg in millions"</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total Weight by Year"</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a>count_yoy <span class="ot">=</span> <span class="fu">ggplot</span>(mc2_edges_aggregated, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">as.factor</span>(year), <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="co">#geom_text(aes(label = weight_sum), vjust = -0.5,color='white') +</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Transactions"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total Transactions by Year"</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a>value_yoy <span class="ot">=</span> <span class="fu">ggplot</span>(mc2_edges_aggregated, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">as.factor</span>(year), <span class="at">y =</span> value_goods_sum<span class="sc">/</span><span class="dv">1000000</span>)) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="co">#geom_text(aes(label = weight_sum), vjust = -0.5,color='white') +</span></span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Value (USD in millions"</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total Value by Year"</span>)</span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a></span>
<span id="cb15-20"><a href="#cb15-20"></a>(count_yoy <span class="sc">+</span> weight_yoy)<span class="sc">/</span>value_yoy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Prepare the nodes for Analysis</strong></p>
<p>The nodes within the node file must be unique and therefore the <code>filter</code> function is used to extract only the nodes that appear based on the <em>source</em> and <em>target</em>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>mc2_nodes_aggregated <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">filter</span>(id  <span class="sc">%in%</span> <span class="fu">c</span>(mc2_edges_aggregated<span class="sc">$</span>source, mc2_edges_aggregated<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="co"># Duplicate the id column as this name will be replaced once we convert to when we apply tbl_graph()</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">distinct</span>() </span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># Replace with NA values in shpcountry and rcvcountry to prevent downstream issue</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>mc2_nodes_aggregated <span class="ot">&lt;-</span> <span class="fu">replace</span>(mc2_nodes_aggregated, <span class="fu">is.na</span>(mc2_nodes_aggregated), <span class="st">'unknown'</span>)</span>
<span id="cb16-10"><a href="#cb16-10"></a></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co"># Save a copy of the nodes file</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="fu">write_rds</span>(mc2_nodes_aggregated, <span class="st">"data/mc2_nodes_aggregated.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># load the node file</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>mc2_nodes_aggregated <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"data/mc2_nodes_aggregated.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Prepare the tbl_graph_object</strong></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mc2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_aggregated,</span>
<span id="cb18-2"><a href="#cb18-2"></a>                           <span class="at">edges =</span> mc2_edges_aggregated, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Derive centrality measures for nodes</strong></p>
<p>Since this is a directed graph, will compute the in-degree centrality, out-degree centrality, closeness and betweenness measures for the nodes.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mc2_graph <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-4"><a href="#cb19-4"></a>          <span class="at">in_deg_centrality =</span> <span class="fu">round</span>(<span class="fu">centrality_degree</span>(<span class="at">weights =</span> weight, <span class="at">mode =</span> <span class="st">"in"</span>, <span class="at">loops =</span> <span class="cn">FALSE</span>),<span class="dv">3</span>),</span>
<span id="cb19-5"><a href="#cb19-5"></a>          <span class="at">out_deg_centrality =</span> <span class="fu">round</span>(<span class="fu">centrality_degree</span>(<span class="at">weights =</span> weight, <span class="at">mode =</span> <span class="st">"out"</span>, <span class="at">loops =</span> <span class="cn">FALSE</span>),<span class="dv">3</span>),</span>
<span id="cb19-6"><a href="#cb19-6"></a>          <span class="at">out_deg_closeness =</span> <span class="fu">round</span>(<span class="fu">centrality_closeness</span>(<span class="at">weights=</span>weight,<span class="at">mode=</span><span class="st">'out'</span>,<span class="at">normalized =</span> <span class="cn">TRUE</span>),<span class="dv">3</span>),</span>
<span id="cb19-7"><a href="#cb19-7"></a>          <span class="at">in_deg_closeness =</span> <span class="fu">round</span>(<span class="fu">centrality_closeness</span>(<span class="at">weights=</span>weight,<span class="at">mode=</span><span class="st">'in'</span>,<span class="at">normalized =</span> <span class="cn">TRUE</span>),<span class="dv">3</span>)) </span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="co"># mutate(combined_degree = in_deg_centrality - out_deg_centrality) %&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="co"># mutate(combi_norm_degree =((combined_degree-min(combined_degree))/(max(combined_degree)-min(combined_degree)) )*100) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Charting a plot</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a>mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'fr'</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weight), </span>
<span id="cb20-6"><a href="#cb20-6"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Remove disconnected nodes and focus on the main graph</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Create a copy of the mc2_graph as we want to preserve the original graph</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>g <span class="ot">&lt;-</span> mc2_graph</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># Extract the graph with the biggest number of the members (main graph)</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="fu">V</span>(g)<span class="sc">$</span>comp <span class="ot">&lt;-</span> <span class="fu">components</span>(g)<span class="sc">$</span>membership</span>
<span id="cb21-6"><a href="#cb21-6"></a>main <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g,<span class="fu">V</span>(g)<span class="sc">$</span>comp<span class="sc">==</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Replot graph to check</p>
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>main <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weight,</span>
<span id="cb22-6"><a href="#cb22-6"></a>                     <span class="at">colour =</span> <span class="fu">factor</span>(year)), </span>
<span id="cb22-7"><a href="#cb22-7"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">scale_color_viridis</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Convert tbl_graph to igraph object</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>igraph_obj <span class="ot">&lt;-</span> main</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># Compute the number of nodes and edges</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>num_nodes <span class="ot">&lt;-</span> <span class="fu">vcount</span>(igraph_obj)</span>
<span id="cb23-6"><a href="#cb23-6"></a>num_edges <span class="ot">&lt;-</span> <span class="fu">ecount</span>(igraph_obj)</span>
<span id="cb23-7"><a href="#cb23-7"></a></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># Print the results</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Num_of_Nodes =</span> num_nodes, <span class="at">Num_of_Edges =</span> num_edges)</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="fu">kable</span>(<span class="fu">head</span>(df), <span class="at">format =</span> <span class="st">'html'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> Num_of_Nodes </th>
   <th style="text-align:right;"> Num_of_Edges </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 151 </td>
   <td style="text-align:right;"> 771 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">#</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>create_graph <span class="ot">&lt;-</span> <span class="cf">function</span>(data, range, title) {</span>
<span id="cb24-3"><a href="#cb24-3"></a>  </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>  </span>
<span id="cb24-6"><a href="#cb24-6"></a>  g <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="fu">as_tbl_graph</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="fu">filter</span>(year <span class="sc">%in%</span> range) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="fu">mutate</span>(</span>
<span id="cb24-12"><a href="#cb24-12"></a>      <span class="at">in_deg_norm =</span> <span class="fu">ifelse</span>(in_deg_centrality <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, (in_deg_centrality <span class="sc">-</span> <span class="fu">min</span>(in_deg_centrality)) <span class="sc">/</span> (<span class="fu">max</span>(in_deg_centrality) <span class="sc">-</span> <span class="fu">min</span>(in_deg_centrality)) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb24-13"><a href="#cb24-13"></a>      <span class="at">out_deg_norm =</span> <span class="fu">ifelse</span>(out_deg_centrality <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span> <span class="sc">-</span> (out_deg_centrality <span class="sc">-</span> <span class="fu">min</span>(out_deg_centrality)) <span class="sc">/</span> (<span class="fu">max</span>(out_deg_centrality) <span class="sc">-</span> <span class="fu">min</span>(out_deg_centrality))))</span>
<span id="cb24-14"><a href="#cb24-14"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>    <span class="fu">mutate</span>(<span class="at">combined_in_out_deg =</span> in_deg_norm <span class="sc">+</span> out_deg_norm) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>    <span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="fu">ifelse</span>((combined_in_out_deg<span class="sc">&gt;=</span><span class="fl">1.6</span>) <span class="sc">|</span> (combined_in_out_deg <span class="sc">&lt;=</span><span class="fl">0.4</span>),row_id,<span class="st">""</span>))</span>
<span id="cb24-17"><a href="#cb24-17"></a>  </span>
<span id="cb24-18"><a href="#cb24-18"></a>  Isolated <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">degree</span>(g) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb24-19"><a href="#cb24-19"></a>  g2 <span class="ot">&lt;-</span> <span class="fu">delete.vertices</span>(g, Isolated)</span>
<span id="cb24-20"><a href="#cb24-20"></a>  </span>
<span id="cb24-21"><a href="#cb24-21"></a>  g2 <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>    <span class="fu">as_tbl_graph</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-23"><a href="#cb24-23"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25"></a>    <span class="fu">geom_edge_fan</span>(</span>
<span id="cb24-26"><a href="#cb24-26"></a>      <span class="fu">aes</span>(<span class="at">color =</span> short_desc),</span>
<span id="cb24-27"><a href="#cb24-27"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">'mm'</span>)),</span>
<span id="cb24-28"><a href="#cb24-28"></a>      <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb24-29"><a href="#cb24-29"></a>      <span class="at">start_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>)</span>
<span id="cb24-30"><a href="#cb24-30"></a>    ) <span class="sc">+</span></span>
<span id="cb24-31"><a href="#cb24-31"></a>    <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">fill =</span> combined_in_out_deg,<span class="at">r =</span> <span class="fl">0.2</span> ),<span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb24-32"><a href="#cb24-32"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"green"</span>, <span class="at">mid =</span> <span class="st">"gray"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">midpoint =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-33"><a href="#cb24-33"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> row_id, <span class="at">size=</span><span class="fl">0.8</span>), <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-34"><a href="#cb24-34"></a>    <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb24-35"><a href="#cb24-35"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb24-36"><a href="#cb24-36"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb24-37"><a href="#cb24-37"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>, <span class="dv">2029</span>,<span class="dv">2030</span>,<span class="dv">2031</span>,<span class="dv">2032</span>,<span class="dv">2033</span>,<span class="dv">2034</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"Main Network of the Trading Entities in 2034"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">

</div>
<p>Temporal Analysis of Individuals and between entities</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">2034</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2028"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">

</div>
<p>test</p>
<ul>
<li><p>ttt</p></li>
<li><p>tt</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2029"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>,<span class="dv">2030</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2030"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>,<span class="dv">2030</span>, <span class="dv">2031</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2031"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>,<span class="dv">2030</span>, <span class="dv">2031</span>, <span class="dv">2032</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2032"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>,<span class="dv">2030</span>, <span class="dv">2031</span>, <span class="dv">2032</span>, <span class="dv">2033</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2033"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell" data-fig.asp="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2028</span>,<span class="dv">2029</span>,<span class="dv">2030</span>, <span class="dv">2031</span>, <span class="dv">2032</span>, <span class="dv">2033</span>, <span class="dv">2034</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">create_graph</span>(main,range,<span class="st">"2034"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
</div>
</div>
<div class="cell">

</div>
<p>Function to plot yearly graph</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p>Centrality measures of various transactions</p>
<p>In-degree, Out-Degree, Betweenness Score</p>
<div class="cell">

</div>
<p>Top 10 nodes with ’in-degree” scores:</p>
<div class="cell">

</div>
<p>View Graph Year by year</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggraph</span>(mc2_graph, <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weight)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="fu">facet_edges</span>(<span class="sc">~</span>year,<span class="at">ncol=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># mc2_nodes_interactive &lt;- mc2_graph %&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">#  activate(nodes) %&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">#  as_tibble() %&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co">#  mutate(title = paste(</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co">#                         '\n In-deg = ',in_deg_centrality, ',',</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#                         "\n Pagerank =", pagerank, ',',</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co">#                         "\n Out-deg =", out_deg_centrality))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>(c) Prepare the group, size</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># mc2_nodes_interactive_in &lt;- mc2_graph %&gt;% </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="co">#   activate(nodes) %&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="co">#   as_tibble() %&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co">#   mutate(class = cut_interval(in_deg_centrality, n = 5, </span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co">#                               style = "quantile")) %&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co">#   rename(group = class)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># visNetwork(mc2_nodes_interactive_in,</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">#            mc2_edges_interactive,</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co">#           main = "Transaction graph grouped by In-Deg centrality intervals",</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co">#            height = "500px", width = "100%") %&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#   visIgraphLayout(layout = "layout_with_fr") %&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co">#   #visNodes(shape = 'dot', value = 'pagerank') %&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">#   visEdges(arrows = 'to',</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="co">#            smooth = list(enables = TRUE,</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">#                          type= 'continuous'),</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="co">#            shadow = FALSE,</span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="co">#            dash = FALSE) %&gt;% </span></span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="co">#   visOptions(highlightNearest = list(enabled = T, degree = 1, hover = T),</span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="co">#              nodesIdSelection = TRUE,</span></span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="co">#              selectedBy = "group") %&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="co">#   visInteraction(hideEdgesOnDrag = TRUE) %&gt;% </span></span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="co">#   visLegend() %&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="co">#   visLayout(randomSeed = 123)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Graph by out degree</p>
<p>(a) Create group</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># mc2_nodes_interactive_out &lt;- mc2_graph %&gt;% </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#   activate(nodes) %&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">#   as_tibble() %&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">#   mutate(class = cut_interval(out_deg_centrality, n = 5, </span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co">#                               style = "quantile")) %&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co">#   rename(group = class)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>(b) Create graph</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># visNetwork(mc2_nodes_interactive_out,</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co">#            mc2_edges_interactive,</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co">#           main = "Transaction graph grouped by Out-Deg centrality intervals",</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co">#            height = "500px", width = "100%") %&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co">#   visIgraphLayout(layout = "layout_with_fr") %&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co">#   #visNodes(shape = 'dot', value = 'pagerank') %&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co">#   visEdges(arrows = 'to',</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="co">#            smooth = list(enables = TRUE,</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="co">#                          type= 'continuous'),</span></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="co">#            shadow = FALSE,</span></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="co">#            dash = FALSE) %&gt;% </span></span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="co">#   visOptions(highlightNearest = list(enabled = T, degree = 1, hover = T),</span></span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="co">#              nodesIdSelection = TRUE,</span></span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="co">#              selectedBy = "group") %&gt;%</span></span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="co">#   visInteraction(hideEdgesOnDrag = TRUE) %&gt;% </span></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="co">#   visLegend() %&gt;%</span></span>
<span id="cb38-17"><a href="#cb38-17"></a><span class="co">#   visLayout(randomSeed = 123)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Look into the to supplier Playa del Tesoro OJSC</p>
<p>(a) Who are its customers</p>
<p>From the map, the sole customer was Fresh Wharf SRL Consulting.</p>
<p>Others include:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># mc2_edges_unique %&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co">#   filter(source == 'Playa del Tesoro OJSC') %&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co">#   group_by(source, target, hscode) %&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co">#   summarise(count=n()) %&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co">#   arrange(desc(count))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get transactions with Fresh Wharf SRL consulting</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># playa &lt;- mc2_edges_aggregated %&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">#   filter(source == 'Playa del Tesoro OJSC') %&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co">#   mutate(month = substr(year_month,start = 6,stop=7))</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="co"># </span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co"># ggplot(playa, </span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co">#        aes(x = month, </span></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="co">#            y = weight,</span></span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="co">#            group = year)) +</span></span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="co">#   geom_line() +</span></span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="co">#   facet_wrap(~year, ncol=1) +</span></span>
<span id="cb40-11"><a href="#cb40-11"></a><span class="co">#   </span></span>
<span id="cb40-12"><a href="#cb40-12"></a><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Heatmap</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># playa_heatmap &lt;- playa %&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#   select(year, month, weight) %&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#   pivot_wider(names_from = month, values_from = weight) </span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co">#   </span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co"># </span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co"># playa_heatmap &lt;- replace(playa_heatmap, is.na(playa_heatmap), 0)</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co"># </span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># row.names(playa_heatmap) &lt;- playa_heatmap$year</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co"># </span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="co"># playa_matrix &lt;- data.matrix(playa_heatmap)</span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="co"># </span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="co"># playa_matrix &lt;- playa_matrix[,-1]</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co"># </span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="co"># heatmap(playa_matrix,Rowv=NA, Colv=NA)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Look at company Estrella de la Costa SRL</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># mc2_edges_fish %&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="co">#   filter(source == 'Estrella de la Costa SRL') %&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="co">#   group_by(source, target, hscode) %&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co">#   summarise(count=n()) %&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="co">#   arrange(desc(count))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the trend</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># estrella &lt;- mc2_edges_aggregated %&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co">#   filter(source == 'Estrella de la Costa SRL') %&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co">#   inner_join(mc2_nodes, select(id, rcvcountry), by = c('source'='id'))</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co"># </span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co"># ggplot(estrella, </span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="co">#        aes(x = year_month, </span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">#            y = weight,</span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">#            group = target)) +</span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#   geom_line() +</span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">#   facet_wrap(~target, ncol=1) +</span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co">#   </span></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>–&gt;Look at company OceanicOrigin Foods Co Consulting</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># mc2_edges_fish %&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">#   filter(source == 'OceanicOrigin Foods Co Consulting') %&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co">#   group_by(source, target, hscode) %&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co">#   summarise(count=n()) %&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co">#   arrange(desc(count))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>check the trend</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># oceanic &lt;- mc2_edges_aggregated %&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co">#   filter(source == 'OceanicOrigin Foods Co Consulting') %&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co">#   inner_join(mc2_nodes, select(id, rcvcountry), by = c('source'='id'))</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co"># </span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co"># ggplot(oceanic, </span></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="co">#        aes(x = year_month, </span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co">#            y = weight,</span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co">#            group = target)) +</span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co">#   geom_line() +</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co">#   facet_wrap(~target, ncol=1) +</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Code block</p>
<div class="cell">

</div>
<p>Code block</p>
<div class="cell">

</div>
<p>Code block</p>
<div class="cell">

</div>
<p>Code block</p>
<div class="cell">

</div>
<p>Code block</p>
<div class="cell">

</div>
<p>References</p>
<ul>
<li><p>Harshita Kanodia (June 2022), IUU Fishing in the Indian Ocean: A Security Threat. Diplomatist, https://diplomatist.com/2022/06/09/lets-catch-the-big-fish/</p></li>
<li></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>